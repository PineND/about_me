<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pine Nguyen</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital@1&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="styling.css">
        <script src="https://cdn.jsdelivr.net/npm/js-yaml@4/dist/js-yaml.min.js"></script>
    </head>
    <body class="root">
        <div id="content"></div>
        <div id="footer" class="footer"></div>
        <script>
            function parseLinks(text) {
                return text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');
            }

            function render(data) {
                const container = document.getElementById('content');
                let html = '';

                for (let i = 0; i < data.length; i++) {
                    const block = data[i];
                    const isLast = i === data.length - 1;
                    if (block.title) {
                        html += `<h1>${block.title}</h1>`;
                    } else if (block.text) {
                        const content = parseLinks(block.text.trim().replace(/\n/g, ' '));
                        html += `<p>${content}</p>`;
                    } else if (block.table) {
                        html += `<table>
                            <tr>
                                <th class="table-timestamp">${block.table.header}</th>
                                <th class="table-description"></th>
                            </tr>`;
                        for (const row of block.table.rows) {
                            const desc = parseLinks(row.description.trim().replace(/\n/g, ' '));
                            html += `<tr>
                                <td class="table-timestamp">${row.timestamp}</td>
                                <td class="table-description">${desc}</td>
                            </tr>`;
                        }
                        html += `</table>`;
                        if (!isLast) html += `<div class="spacer"></div>`;
                    }
                }

                container.innerHTML = html;
            }

            fetch('Markdown_updater.md')
                .then(res => res.text())
                .then(text => {
                    const data = jsyaml.load(text);
                    render(data);
                });

            fetch('https://api.github.com/repos/PineND/about_me/commits?per_page=1')
                .then(res => res.json())
                .then(commits => {
                    if (commits && commits[0]) {
                        const date = new Date(commits[0].commit.author.date);
                        const formatted = date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                        document.getElementById('footer').innerHTML = `<p>Last updated: ${formatted}</p>`;
                    }
                })
                .catch(() => {});
        </script>
        <script data-goatcounter="https://pinenguyen.goatcounter.com/count"
                async src="//gc.zgo.at/count.js"></script>
    </body>
</html>
